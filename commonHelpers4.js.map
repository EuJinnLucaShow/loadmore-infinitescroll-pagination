{"version":3,"file":"commonHelpers4.js","sources":["../src/js/pagination.js"],"sourcesContent":["import '../sass/index.scss';\nimport ApiService from './api';\nimport { lightbox } from './lightbox';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst searchButton = document.getElementById('search-button');\nconst galleryContainer = document.querySelector('.gallery');\nconst searchQueryInput = document.getElementById('search-bar');\nconst paginationContainer = document.getElementById('pagination-container')\nconst paginationByttons = document.getElementById('pagination-numbers');\nconst prevButton = document.getElementById('prev-button');\nconst nextButton = document.getElementById('next-button');\n\nlet isShown = 0;\nlet isFirstSearch = true;\nlet currentPage = 1;\nlet query = ''\nconst api = new ApiService();\n\nsearchButton.addEventListener(\"click\", function(event) {  \n  event.preventDefault();\n  onSearch();\n  isFirstSearch = true;    \n});\n\nsearchQueryInput.addEventListener(\"keydown\", function(event) {\n  if (event.key === 'Enter') {\n    event.preventDefault();\n    onSearch();\n  }\n    isFirstSearch = true;    \n});\n\nprevButton.addEventListener('click', () => setCurrentPage(currentPage - 1));\nnextButton.addEventListener('click', () => setCurrentPage(currentPage + 1));\n\nasync function onSearch() {\n  const searchQuery = searchQueryInput.value.trim();\n  \n  api.query = searchQuery;  \n\n  if (searchQuery === '') {\n    showToast('warning', 'Please, fill the main field');\n    paginationContainer.classList.add('is-hidden')\n    return;\n  }\n\n  if (searchQuery === query) {    \n    showToast('warning', 'Please, modify or enter a new search field.');\n    return;\n  }\n\n  galleryContainer.innerHTML = '';\n  api.resetPage();\n  query = searchQuery;\n  isShown = 0;\n  await fetchGallery(1);\n}\n\nasync function fetchGallery(currentPage) {\n  try {\n    api.getPage(currentPage)\n    const result = await api.fetchGallery();\n    const { hits, totalHits } = result;\n\n    if (!hits.length) {\n      showToast('error', 'Sorry, no images matching your search query. Please try again.');\n      paginationContainer.classList.add('is-hidden')\n      return;\n    }\n\n    if (isFirstSearch && isShown < totalHits) {\n      showToast('success', `Hooray! We found ${totalHits} images !!!`);\n      isFirstSearch = false;\n      setupPagination({ hits, totalHits });\n    }\n\n    galleryContainer.innerHTML = '';\n    onRenderGallery(hits);\n    isShown += hits.length;\n\n    if (isShown >= totalHits) {\n      showToast('info', \"You've reached the end of search results.\");\n    }\n  } catch (error) {\n    console.error('Error fetching gallery:', error);\n    showToast('error', 'An error occurred while fetching the gallery.');\n  }\n}\n\nfunction onRenderGallery(elements) {\n  const markup = elements\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n      <div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n          <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes</b><span class=\"info__span\">${likes}</span></p>\n          <p class=\"info-item\"><b>Views</b><span class=\"info__span\">${views}</span></p>\n          <p class=\"info-item\"><b>Comments</b><span class=\"info__span\">${comments}</span></p>\n          <p class=\"info-item\"><b>Downloads</b><span class=\"info__span\">${downloads}</span></p>\n        </div>\n      </div>`\n    )\n    .join('');\n\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nfunction showToast(type, message) {\n  iziToast[type]({\n    title: type.charAt(0).toUpperCase() + type.slice(1),\n    message: message,\n    position: 'topRight',\n    color: type === 'success' ? 'green' : type === 'warning' ? 'yellow' : type === 'error' ? 'red' : 'blue',\n    timeout: 2000,\n    closeOnEscape: true,\n    closeOnClick: true,\n  });\n}\n\nfunction setupPagination({ hits, totalHits }) {\n  \n  const pageCount = Math.ceil(totalHits / hits.length);\n\n  paginationByttons.innerHTML = '';\n\n  for (let i = 1; i <= pageCount; i++) {\n    const pageNumber = document.createElement('button');\n    pageNumber.className = 'pagination-number';\n    pageNumber.textContent = i;\n\n    paginationByttons.appendChild(pageNumber);\n    paginationContainer.classList.remove('is-hidden')\n    pageNumber.addEventListener('click', () => {\n      setCurrentPage(i);\n    });    \n  }\n  handlePageButtonsStatus();\n}\n\nfunction setCurrentPage(i) {\n  currentPage = i; \n  fetchGallery(currentPage);\n  handlePageButtonsStatus();\n}\n\nfunction handlePageButtonsStatus() {\n  prevButton.disabled = currentPage === 1;\n  nextButton.disabled = currentPage ===  paginationByttons.children.length;\n}\n\nprevButton.addEventListener('click', () => {\n  setCurrentPage(currentPage - 1);\n});\n\nnextButton.addEventListener('click', () => {\n  setCurrentPage(currentPage + 1);\n});\n"],"names":["searchButton","galleryContainer","searchQueryInput","paginationContainer","paginationByttons","prevButton","nextButton","isShown","isFirstSearch","currentPage","query","api","ApiService","event","onSearch","setCurrentPage","searchQuery","showToast","fetchGallery","result","hits","totalHits","setupPagination","onRenderGallery","error","elements","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","type","message","iziToast","pageCount","i","pageNumber","handlePageButtonsStatus"],"mappings":"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"}